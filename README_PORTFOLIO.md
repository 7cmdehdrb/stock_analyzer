# 포트폴리오 성과 분석기

Python 기반 웹 애플리케이션으로 주식 포트폴리오의 성과를 분석합니다.

## 주요 기능

1. **CSV 파일 업로드**: 보유 주식 포트폴리오 데이터를 CSV로 업로드
2. **자동 데이터 수집**: Yahoo Finance API를 통한 과거 주가 데이터 자동 수집
3. **DB 캐싱**: SQLite를 활용한 주가 데이터 캐싱으로 빠른 재분석
4. **현금 자산 관리**: 현금 보유액을 포함한 전체 포트폴리오 분석
5. **성과 지표 계산**:
   - 샤프 비율 (Sharpe Ratio)
   - 소티노 비율 (Sortino Ratio)
   - 알파 (Alpha)
   - 베타 (Beta)
   - 연평균 수익률 (CAGR)
   - 변동성
6. **벤치마크 비교**: 선택한 벤치마크(SPY, QQQ 등)와 성과 비교
7. **시각화**: 
   - 누적 수익률 차트
   - 시작/현재 시점 자산 배분 도넛 차트
8. **다중 통화 지원**: USD/KRW 자동 환산

## 설치 방법

### 1. 필요한 패키지 설치

```powershell
pip install -r requirements.txt
```

또는 개별 설치:

```powershell
pip install Flask pandas yfinance numpy
```

### 2. 프로그램 실행

```powershell
python portfolio.py
```

### 3. 브라우저에서 접속

프로그램이 실행되면 웹 브라우저에서 아래 주소로 접속:

```
http://localhost:5000
```

## CSV 파일 형식

CSV 파일은 최소한 다음 컬럼을 **필수적으로** 포함해야 합니다:

- **티커**: 종목의 티커 심볼 (예: AAPL, MSFT, 005930.KS)
- **보유량**: 보유 주식 수량
- **국가**: 종목의 국가 (예: 미국, 한국)

### 예시 CSV

```csv
티커,보유량,국가,평단가,종목명,통화,분류,섹터
AAPL,10,미국,150.00,Apple Inc,USD,우량주,첨단기술
MSFT,5,미국,300.00,Microsoft Corp,USD,우량주,첨단기술
SPY,20,미국,400.00,SPDR S&P 500 ETF,USD,지수,ETF
005930.KS,50,한국,70000,삼성전자,KRW,우량주,첨단기술
069500.KS,100,한국,51000,KODEX 200,KRW,지수,ETF
```

**중요**: 
- 미국 주식은 티커만 입력 (예: AAPL, MSFT)
- 한국 주식은 ".KS" 또는 ".KQ" 붙이기 (예: 005930.KS - 삼성전자)
- ETF 코드 그대로 사용 가능 (예: 069500.KS - KODEX 200)

## 사용 방법

1. **CSV 파일 준비**: 보유 포트폴리오 정보를 CSV 파일로 준비 (티커, 보유량, 국가 필수)
2. **파일 업로드**: 웹 페이지에서 CSV 파일 업로드
3. **시작 일자 선택**: 분석을 시작할 날짜 입력 (포트폴리오 시작일)
4. **벤치마크 선택**: 비교할 벤치마크 티커 입력
   - SPY: S&P 500
   - QQQ: NASDAQ 100
   - ^GSPC: S&P 500 지수
   - ^DJI: 다우존스 지수
5. **기준 통화 선택**: 포트폴리오를 평가할 기준 통화 선택 (USD 또는 KRW)
   - USD 선택 시: 한국 주식이 USD로 환산됨
   - KRW 선택 시: 미국 주식이 KRW로 환산됨
   - 환율은 현재 환율 기준으로 적용됨
6. **분석 시작**: 버튼 클릭 후 결과 확인

## 계산 지표 설명

### 샤프 비율 (Sharpe Ratio)
- 위험 대비 수익률을 측정
- 1.0 이상이면 양호, 2.0 이상이면 우수
- 높을수록 좋음

### 소티노 비율 (Sortino Ratio)
- 하방 위험만 고려한 수익률 측정
- 샤프 비율과 유사하나 손실 변동성만 측정
- 높을수록 좋음

### 알파 (Alpha)
- 벤치마크 대비 초과 수익률
- 양수면 벤치마크를 초과 달성
- 높을수록 좋음

### 베타 (Beta)
- 시장 대비 변동성
- 1.0 = 시장과 동일한 변동성
- 1.0 초과 = 시장보다 변동성 큼
- 1.0 미만 = 시장보다 변동성 작음

### 연평균 수익률 (CAGR)
- 복리 기준 연간 수익률
- 장기 투자 성과 측정에 유용

### 변동성 (Volatility)
- 연간 표준편차
- 낮을수록 안정적인 포트폴리오

## 문제 해결

### 티커를 찾을 수 없다는 오류
- 티커 심볼이 정확한지 확인
- 한국 주식의 경우 ".KS" 또는 ".KQ" 추가
- Yahoo Finance에서 지원하는 티커인지 확인

### 데이터를 가져올 수 없다는 오류
- 인터넷 연결 확인
- 시작 날짜가 너무 오래되지 않았는지 확인
- 벤치마크 티커가 올바른지 확인

### CSV 파일 오류
- 파일이 UTF-8 인코딩인지 확인
- "티커"와 "보유량" 컬럼이 있는지 확인
- CSV 구분자가 쉼표(,)인지 확인

## 기술 스택

- **Backend**: Flask (Python)
- **Data**: pandas, yfinance, numpy
- **Frontend**: HTML, CSS, JavaScript
- **Charts**: Chart.js

## 라이선스

MIT License
